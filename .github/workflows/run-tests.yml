name: run-tests

on: [push, pull_request]
env:
    COMPOSER_TOKEN: ${{ secrets.GITHUB_TOKEN }}
    DB_DATABASE: unit_tests
jobs:
    tests:
        runs-on: ${{ matrix.os }}
        strategy:
            fail-fast: true
            matrix:
                os: [ubuntu-latest]
                php: [7.4]
                laravel: [8.*]
                dependency-version: [prefer-lowest, prefer-stable]
                include:
                    -   laravel: 8.*
                        testbench: 6.*

        name: P${{ matrix.php }} - L${{ matrix.laravel }} - ${{ matrix.dependency-version }}
        steps:
            -   id: foo
                uses: Daalder/run-tests-action@1dcd1f4b4d895223989677f16f6f5b5423768734
                env:
                    GITHUB_TOKEN: ${{ env.GITHUB_TOKEN }}
                    PACKAGIST_TOKEN: ${{ secrets.DAALDER }}
                    SLACK_BEARER_TOKEN: ${{ secrets.SLACK_BEARER_TOKEN }}
